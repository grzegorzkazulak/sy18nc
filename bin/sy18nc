#!/usr/bin/env ruby
require_relative "../lib/sy18nc"

require 'optparse'

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: sy18nc [options]"

  opts.on("-b", "--backup", "Create backup") do |b|
    options[:backup] = b
  end
end.parse!

def synchronize_using_config
  Sy18nc.config.synchronizable.each do |s|
    files = [Sy18nc.config.locales.dir]
    files << Sy18nc.config.locales.map do |l|
      "#{s}.#{l}"
    end

    synchronizer = Sy18nc::Synchronizer.new(files, options)
    synchronizer.synchronize_all
  end
end

if ARGS.empty?
  synchronize_using_config
else
  synchronizer = Sy18nc::Synchronizer.new(*ARGV, options)
  synchronizer.synchronize_all
end
